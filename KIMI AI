"""
Step-by-Step Solution: Microstrip TE Transverse Resonance Frequency

Problem Analysis:
- This is a transverse resonance problem in microstrip lines
- At high frequencies, the microstrip width W acts like a parallel-plate waveguide
- The lowest order TE mode resonates when the effective width equals λg/2
- Fringing fields increase the effective electrical width beyond the physical width W
"""

import math

# Step 1: Identify and define the given parameters
W = 2.1e-3       # Strip width = 2.1 mm (converted to meters)
h = 1.0e-3       # Substrate thickness = 1.0 mm (converted to meters)
epsilon_r = 9.0  # Substrate relative permittivity
c = 3e8          # Speed of light in vacuum (m/s)

print("Step 1: Given Parameters")
print(f"  - Strip width (W) = {W*1000:.1f} mm")
print(f"  - Substrate thickness (h) = {h*1000:.1f} mm")
print(f"  - Relative permittivity (εr) = {epsilon_r}")
print(f"  - W/h ratio = {W/h:.1f} (>1, so wide microstrip approximation applies)")
print()

# Step 2: Calculate effective width accounting for fringing capacitance
# For wide microstrip lines (W/h > 1), fringing extends approximately 
# 0.2h on each side, giving total extension of 0.4h
# Formula: Weff = W + 0.4h

fringe_extension = 0.4 * h
W_eff = W + fringe_extension

print("Step 2: Effective Width Calculation (including fringing)")
print(f"  - Fringing extension = 0.4h = {fringe_extension*1000:.2f} mm")
print(f"  - Physical width W = {W*1000:.1f} mm")
print(f"  - Effective width Weff = W + 0.4h = {W*1000:.1f} + {fringe_extension*1000:.2f} = {W_eff*1000:.2f} mm")
print()

# Step 3: Apply transverse resonance condition
# For the lowest order TE mode, resonance occurs when:
# Weff = λg/2 = λ0/(2√εr) = c/(2f√εr)
# Solving for f: f = c/(2*Weff*√εr)

print("Step 3: Transverse Resonance Condition")
print("  - Lowest order TE mode condition: Weff = λg/2")
print("  - Guided wavelength λg = λ0/√εr = c/(f√εr)")
print("  - Therefore: f = c/(2*Weff*√εr)")
print()

# Step 4: Calculate the resonance frequency
sqrt_epsilon_r = math.sqrt(epsilon_r)
f_resonance = c / (2 * W_eff * sqrt_epsilon_r)
f_resonance_GHz = f_resonance / 1e9

print("Step 4: Calculate Resonance Frequency")
print(f"  - √εr = √{epsilon_r} = {sqrt_epsilon_r}")
print(f"  - f = c / (2 * Weff * √εr)")
print(f"  - f = {c:.0e} / (2 * {W_eff:.3e} * {sqrt_epsilon_r})")
print(f"  - f = {f_resonance_GHz:.1f} GHz")
print()

# Step 5: Compare with given options
options = {
    'a': 10,
    'b': 20,
    'c': 25,
    'd': 30
}

print("Step 5: Match with Given Options")
print(f"  - Calculated value: {f_resonance_GHz:.1f} GHz")
print(f"  - Option (a): {options['a']} GHz")
print(f"  - Option (b): {options['b']} GHz  ← Closest match (exact)")
print(f"  - Option (c): {options['c']} GHz")
print(f"  - Option (d): {options['d']} GHz")
print()

# Verification: Calculate what Weff would be for other options
print("Verification:")
for label, freq in options.items():
    weff_for_freq = c / (2 * freq * 1e9 * sqrt_epsilon_r)
    print(f"  - For {freq} GHz, required Weff = {weff_for_freq*1000:.2f} mm")

print()
print("="*60)
print("CONCLUSION: The answer is (b) 20 GHz")
print("="*60)
print("""
Physics Explanation:
The TE transverse resonance occurs when electromagnetic waves bounce 
between the edges of the microstrip (acting like a parallel-plate 
waveguide). The fringing fields at the edges increase the effective 
electrical width to approximately Weff = W + 0.4h = 2.5 mm, lowering 
the resonant frequency from the ideal 23.8 GHz (without fringing) 
to exactly 20 GHz.
""")
